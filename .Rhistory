_**La partici&oacute;n de la variaci&oacute;n** es un tipo de an&aacute;lisis que combina un **RDA simple** y un **RDA parcial** para dividir la variaci&oacute;n de una variable de respuesta entre dos, tres o cuatro conjuntos de datos explicativos. La partici&oacute;n de variaci&oacute;n generalmente se representa mediante un diagrama de Venn en el que se informa el porcentaje de varianza explicada por cada conjunto de datos explicativos (o combinaci&oacute;n de stets de datos)._
<br/>
#### **Step 1: Partition the Variation**
_Construir el modelo y ejecutar un RDA con las matrices (diferentes factores) separadas._
```{r}
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~plants + land_use + margin, ~season, data = env_1)
varp
```
Legendre (2008) argued that "Negative values of Adj. R<sup>2</sup> are interpreted as zeros; they correspond to cases where the explanatory variables explain less variation than random normal variables would."<br>
_Legendre (2008) sugiere que "**los valores negativos de Adj. R<sup>2</sup> se interpretan como ceros**". Estos valores corresponden a casos donde las variables explicativas explican menos variaci&oacute;n que las variables normales aleatorias"_
<br/>
#### **Step 2: Partition the Variation**
Plot the results. The plot shows the adjusted R<sup>2</sup> values associated with each partition or for overlapping partitions.<br>
_Graficar los resultados. El gr&aacute;fico muestra los valores de R<sup>2</sup> ajustados asociados con cada partici&oacute;n o para particiones superpuestas._
```{r}
plot(varp, digits = 2, Xnames = c('Enviromental factors', 'Vegetation', "Season"),
bg = c('navy', 'tomato', "lightblue"))
```{r}
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~plants + land_use + margin, ~season,
~richness + abundance + shannon, data = env_1)
varp
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~plants + land_use + margin, ~season,
~richness + abundance + shannon, data = env_1)
varp
#### **Step 1: Partition the Variation**
_Construir el modelo y ejecutar un RDA con las matrices (diferentes factores) separadas._
```{r}
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~plants + land_use + margin, ~season,
~richness + abundance + shannon, data = env_1)
varp
```
Legendre (2008) argued that "Negative values of Adj. R<sup>2</sup> are interpreted as zeros; they correspond to cases where the explanatory variables explain less variation than random normal variables would."<br>
_Legendre (2008) sugiere que "**los valores negativos de Adj. R<sup>2</sup> se interpretan como ceros**". Estos valores corresponden a casos donde las variables explicativas explican menos variaci&oacute;n que las variables normales aleatorias"_
<br/>
#### **Step 2: Partition the Variation**
Plot the results. The plot shows the adjusted R<sup>2</sup> values associated with each partition or for overlapping partitions.<br>
_Graficar los resultados. El gr&aacute;fico muestra los valores de R<sup>2</sup> ajustados asociados con cada partici&oacute;n o para particiones superpuestas._
```{r}
plot(varp, digits = 2, Xnames = c('Enviromental factors', 'Vegetation', "Season"),
bg = c('navy', 'tomato', "lightblue"))
```{r}
plot(varp, digits = 2, Xnames = c('Enviromental factors', 'Vegetation',
"Season","Macroinvertebrates"),
bg = c('navy', 'tomato', "lightblue","gold"))
```{r}
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~plants + land_use + margin, ~season,
shannon, data = env_1)
varp
```{r}
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~plants + land_use + margin, ~season,
~shannon, data = env_1)
varp
```{r}
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~ plants + land_use + margin, ~season,
~ shannon, data = env_1)
varp
plot(varp, digits = 2, Xnames = c('Enviromental factors', 'Vegetation',
"Season","Macroinvertebrates"),
bg = c('navy', 'tomato', "lightblue","gold"))
# significance of partition from Environment (physicochemical variables)
anova(rda(species.hel ~ temperature + oxygen + pH + conductivity +
Condition(plants + land_use + margin) +
Condition(season) + Condition(shannon), data=env_1))
# Significance of partition from Physical characteristics
anova(rda(species.hel ~ plants + land_use + margin +
Condition(temperature + oxygen + pH + conductivity) +
Condition(season),+ Condition(shannon), data=env_1))
# Significance of partition from Physical characteristics
anova(rda(species.hel ~ plants + land_use + margin +
Condition(temperature + oxygen + pH + conductivity) +
Condition(season) + Condition(shannon), data=env_1))
# Significance of partition from Season
anova(rda(species.hel ~ season +
Condition(plants + land_use + margin) +
Condition(temperature + oxygen + pH + conductivity)
+ Condition(shannon), data=env_1))
anova(rda(species.hel ~ shannon +
Condition(plants + land_use + margin) +
Condition(temperature + oxygen + pH + conductivity)
+ Condition(season), data=env_1))
library(ggplot2)
library(dplyr)
library(vegan)
library(ggplot2)
library(dplyr)
library(vegan)
<br/>
#### **Step 2**
Data<br>
_Cargar los datos._
```{r}
species=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_species.csv", header=T, row.names=NULL, sep=",")
env=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_environmetal_standart.csv", header=T, row.names=NULL, sep=",")
```
<br/>
#### **Step 3**
_Remover la columna de sitos._
```{r}
species_1 <- select(species, -site)
env_1 <- select(env, -site)
```
<br/>
#### **Step 4**
**_Transformar datos._** _Hellinger es una transformaci&aacute;n recomendada por Legendre & Callagher (2001) en datos de abundancia y con una respuesta lineal._
```{r}
species.hel <- decostand(species_1, method = "hellinger")
```
<br/>
## **Variation partitioning by partial RDA**
**Variation partitioning** is a type of analysis that combines **simple RDA** and **partial RDA** to divide the variation of a response variable among two, three or four explanatory data sets. Variation partitioning are generally represented by Venn diagram in which the percentage of explained variance by each explanatory data set (or combination of data stets) is reported.<br>
_**La partici&oacute;n de la variaci&oacute;n** es un tipo de an&aacute;lisis que combina un **RDA simple** y un **RDA parcial** para dividir la variaci&oacute;n de una variable de respuesta entre dos, tres o cuatro conjuntos de datos explicativos. La partici&oacute;n de variaci&oacute;n generalmente se representa mediante un diagrama de Venn en el que se informa el porcentaje de varianza explicada por cada conjunto de datos explicativos (o combinaci&oacute;n de stets de datos)._
<br/>
#### **Step 1: Partition the Variation**
_Construir el modelo y ejecutar un RDA con las matrices (diferentes factores) separadas._
```{r}
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~ plants + land_use + margin, ~season,
~ shannon, data = env_1)
varp
```
Legendre (2008) argued that "Negative values of Adj. R<sup>2</sup> are interpreted as zeros; they correspond to cases where the explanatory variables explain less variation than random normal variables would."<br>
_Legendre (2008) sugiere que "**los valores negativos de Adj. R<sup>2</sup> se interpretan como ceros**". Estos valores corresponden a casos donde las variables explicativas explican menos variaci&oacute;n que las variables normales aleatorias"_
```{r}
species=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_species.csv", header=T, row.names=NULL, sep=",")
env=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_environmetal_standart.csv", header=T, row.names=NULL, sep=",")
species=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_species.csv", header=T, row.names=NULL, sep=",")
env=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_environmetal_standart.csv", header=T, row.names=NULL, sep=",")
<br/>
#### **Step 3**
_Remover la columna de sitos._
```{r}
species_1 <- select(species, -site)
env_1 <- select(env, -site)
```
<br/>
env_1 <- select(env, -site)
species.hel <- decostand(species_1, method = "hellinger")
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~ plants + land_use + margin, ~season,
~ shannon, data = env_1)
View(env)
species=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_species.csv", header=T, row.names=NULL, sep=",")
env=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_environmetal_standart.csv", header=T, row.names=NULL, sep=",")
species=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_species.csv", header=T, row.names=NULL, sep=",")
env=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_environmetal_standart.csv", header=T, row.names=NULL, sep=",")
<br/>
#### **Step 3**
_Remover la columna de sitos._
```{r}
species_1 <- select(species, -site)
env_1 <- select(env, -site)
```
<br/>
#### **Step 4**
**_Transformar datos._** _Hellinger es una transformaci&aacute;n recomendada por Legendre & Callagher (2001) en datos de abundancia y con una respuesta lineal._
```{r}
species.hel <- decostand(species_1, method = "hellinger")
```
<br/>
## **Variation partitioning by partial RDA**
**Variation partitioning** is a type of analysis that combines **simple RDA** and **partial RDA** to divide the variation of a response variable among two, three or four explanatory data sets. Variation partitioning are generally represented by Venn diagram in which the percentage of explained variance by each explanatory data set (or combination of data stets) is reported.<br>
_**La partici&oacute;n de la variaci&oacute;n** es un tipo de an&aacute;lisis que combina un **RDA simple** y un **RDA parcial** para dividir la variaci&oacute;n de una variable de respuesta entre dos, tres o cuatro conjuntos de datos explicativos. La partici&oacute;n de variaci&oacute;n generalmente se representa mediante un diagrama de Venn en el que se informa el porcentaje de varianza explicada por cada conjunto de datos explicativos (o combinaci&oacute;n de stets de datos)._
<br/>
#### **Step 1: Partition the Variation**
_Construir el modelo y ejecutar un RDA con las matrices (diferentes factores) separadas._
```{r}
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~ plants + land_use + margin, ~season,
~ shannon, data = env_1)
varp
```
Legendre (2008) argued that "Negative values of Adj. R<sup>2</sup> are interpreted as zeros; they correspond to cases where the explanatory variables explain less variation than random normal variables would."<br>
_Legendre (2008) sugiere que "**los valores negativos de Adj. R<sup>2</sup> se interpretan como ceros**". Estos valores corresponden a casos donde las variables explicativas explican menos variaci&oacute;n que las variables normales aleatorias"_
varp
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~ plants + land_use + margin, ~season,
~ shannon, data = env_1)
env=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_environmetal_standart.csv", header=T, row.names=NULL, sep=",")
species=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_species.csv", header=T, row.names=NULL, sep=",")
env=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_environmetal_standart.csv", header=T, row.names=NULL, sep=",")
<br/>
#### **Step 3**
_Remover la columna de sitos._
```{r}
species_1 <- select(species, -site)
env_1 <- select(env, -site)
```
<br/>
#### **Step 4**
**_Transformar datos._** _Hellinger es una transformaci&aacute;n recomendada por Legendre & Callagher (2001) en datos de abundancia y con una respuesta lineal._
```{r}
species.hel <- decostand(species_1, method = "hellinger")
```
<br/>
## **Variation partitioning by partial RDA**
**Variation partitioning** is a type of analysis that combines **simple RDA** and **partial RDA** to divide the variation of a response variable among two, three or four explanatory data sets. Variation partitioning are generally represented by Venn diagram in which the percentage of explained variance by each explanatory data set (or combination of data stets) is reported.<br>
_**La partici&oacute;n de la variaci&oacute;n** es un tipo de an&aacute;lisis que combina un **RDA simple** y un **RDA parcial** para dividir la variaci&oacute;n de una variable de respuesta entre dos, tres o cuatro conjuntos de datos explicativos. La partici&oacute;n de variaci&oacute;n generalmente se representa mediante un diagrama de Venn en el que se informa el porcentaje de varianza explicada por cada conjunto de datos explicativos (o combinaci&oacute;n de stets de datos)._
<br/>
#### **Step 1: Partition the Variation**
_Construir el modelo y ejecutar un RDA con las matrices (diferentes factores) separadas._
```{r}
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~ plants + land_use + margin, ~season,
~ shannon, data = env_1)
varp
```
Legendre (2008) argued that "Negative values of Adj. R<sup>2</sup> are interpreted as zeros; they correspond to cases where the explanatory variables explain less variation than random normal variables would."<br>
_Legendre (2008) sugiere que "**los valores negativos de Adj. R<sup>2</sup> se interpretan como ceros**". Estos valores corresponden a casos donde las variables explicativas explican menos variaci&oacute;n que las variables normales aleatorias"_
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~ plants + land_use + margin, ~season,
~ shannon, data = env_1)
varp
plot(varp, digits = 2, Xnames = c('Enviromental factors', 'Vegetation',
"Season","Macroinvertebrates"),
bg = c('navy', 'tomato', "lightblue","gold"))
```{r, warning=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)
library(vegan)
library(ggplot2)
library(dplyr)
library(vegan)
<br/>
#### **Step 2**
Data<br>
_Cargar los datos._
```{r}
species=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_species.csv", header=T, row.names=NULL, sep=",")
env=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_environmetal_standart.csv", header=T, row.names=NULL, sep=",")
```
```{r}
species=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_species.csv", header=T, row.names=NULL, sep=",")
env=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_environmetal_standart.csv", header=T, row.names=NULL, sep=",")
species=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_species.csv", header=T, row.names=NULL, sep=",")
env=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_environmetal_standart.csv", header=T, row.names=NULL, sep=",")
<br/>
#### **Step 3**
_Remover la columna de sitos._
```{r}
species_1 <- select(species, -site)
env_1 <- select(env, -site)
```
<br/>
#### **Step 4**
**_Transformar datos._** _Hellinger es una transformaci&aacute;n recomendada por Legendre & Callagher (2001) en datos de abundancia y con una respuesta lineal._
```{r}
species.hel <- decostand(species_1, method = "hellinger")
```
<br/>
## **Partial RDA**
Basic formula:  rda(Y ~ X + Condition(Z))<br>
_La formula b&aacute;sica es:  rda(Y ~ X + Condition(Z))_<br>
Partial RDA is a special case of RDA in which the response variables Y are related to explanatory variables X in the presence of additional explanatory variables, W, called covariables.<br>
_Un RDA parcial es un caso especial de un RDA simple en el que las **variables de respuesta Y** est&aacute;n relacionadas con las **variables explicativas X** en presencia de **variables explicativas adicionales, W,** llamadas **covariables**._<br>
Partial RDA is thus a powerful tool when users what to assess the effect of environmental variables on species composition while taking into account the species variation due to other environmental variables with no interest.
_Por lo tanto, un RDA parcial es una herramienta poderosa cuando los usuarios eval&uacute;an el efecto de las variables ambientales en la composici&oacute;n de las especies, teniendo en cuenta la variaci&oacute;n de las especies debido a otras variables ambientales sin "inter&eacute;s"._<br>
More information: Borcard et al (2012). page 172
<br>
#### **Step 1: partial RDA**
_Construir los modelos y ejecutar un RDA simple y un RDA parcial (i.e., controlado por covariables)._
```{r}
simple_rda <- rda(species.hel ~ temperature + oxygen + pH + conductivity +
plants + land_use + margin + season, data = env_1)
partial_rda <- rda(species.hel ~ temperature + oxygen + pH + conductivity +
plants + land_use + margin +
Condition(season), data = env_1)
# anova(partial_rda, permutations = how(nperm = 999))
```
<br/>
#### **Step 2: partial RDA**
Plot the results
```{r}
#Construct the triplots
#Scaling 1
plot(partial_rda, scaling=1, main="Triplot partial RDA - scaling 1", type="none", xlab=c("RDA1"), ylab=c("RDA2"), xlim=c(-1,1), ylim=c(-1,1))
points(scores(partial_rda, display="sites", choices=c(1,2), scaling=1),
pch=21, col="black", bg="steelblue", cex=1.2)
arrows(0,0,
scores(partial_rda, display="species", choices=c(1), scaling=1),
scores(partial_rda, display="species", choices=c(2), scaling=1),
col="black",length=0)
text(scores(partial_rda, display="species", choices=c(1), scaling=1),
scores(partial_rda, display="species", choices=c(2), scaling=1),
labels=rownames(scores(partial_rda, display="species", scaling=1)),
col="black", cex=0.8)
arrows(0,0,
scores(partial_rda, display="bp", choices=c(1), scaling=1),
scores(partial_rda, display="bp", choices=c(2), scaling=1),
col="red")
text(scores(partial_rda, display="bp", choices=c(1), scaling=1)+0.05,
scores(partial_rda, display="bp", choices=c(2), scaling=1)+0.05,
labels=rownames(scores(partial_rda, display="bp", choices=c(2), scaling=1)),
col="red", cex=1)
#Scaling 2
plot(partial_rda, scaling=2, main="Triplot partial RDA - scaling 2", type="none", xlab=c("RDA1"), ylab=c("RDA2"), xlim=c(-1,1), ylim=c(-1,1))
points(scores(partial_rda, display="sites", choices=c(1,2), scaling=2),
pch=21, col="black", bg="steelblue", cex=1.2)
arrows(0,0,
scores(partial_rda, display="species", choices=c(1), scaling=2),
scores(partial_rda, display="species", choices=c(2), scaling=2),
col="black",length=0)
text(scores(partial_rda, display="species", choices=c(1), scaling=2),
scores(partial_rda, display="species", choices=c(2), scaling=2),
labels=rownames(scores(partial_rda, display="species", scaling=2)),
col="black", cex=0.8)
arrows(0,0,
scores(partial_rda, display="bp", choices=c(1), scaling=2),
scores(partial_rda, display="bp", choices=c(2), scaling=2),
col="red")
text(scores(partial_rda, display="bp", choices=c(1), scaling=2)+0.05,
scores(partial_rda, display="bp", choices=c(2), scaling=2)+0.05,
labels=rownames(scores(partial_rda, display="bp", choices=c(2), scaling=2)),
col="red", cex=1)
<br/>
#### **References**
https://wiki.qcbs.ca/r_workshop10
Legendre, P., & Legendre, L. (2012). Numerical ecology. Elsevier.
<br/>
<br/>
library(ggplot2)
library(dplyr)
library(vegan)
library(ggplot2)
library(dplyr)
library(vegan)
<br/>
#### **Step 2**
Data<br>
_Cargar los datos._
```{r}
species=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_species.csv", header=T, row.names=NULL, sep=",")
env=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_environmetal_standart.csv", header=T, row.names=NULL, sep=",")
```
<br/>
#### **Step 3**
_Remover la columna de sitos._
```{r}
species_1 <- select(species, -site)
env_1 <- select(env, -site)
```
<br/>
#### **Step 4**
**_Transformar datos._** _Hellinger es una transformaci&aacute;n recomendada por Legendre & Callagher (2001) en datos de abundancia y con una respuesta lineal._
```{r}
species.hel <- decostand(species_1, method = "hellinger")
```
<br/>
## **Variation partitioning by partial RDA**
**Variation partitioning** is a type of analysis that combines **simple RDA** and **partial RDA** to divide the variation of a response variable among two, three or four explanatory data sets. Variation partitioning are generally represented by Venn diagram in which the percentage of explained variance by each explanatory data set (or combination of data stets) is reported.<br>
_**La partici&oacute;n de la variaci&oacute;n** es un tipo de an&aacute;lisis que combina un **RDA simple** y un **RDA parcial** para dividir la variaci&oacute;n de una variable de respuesta entre dos, tres o cuatro conjuntos de datos explicativos. La partici&oacute;n de variaci&oacute;n generalmente se representa mediante un diagrama de Venn en el que se informa el porcentaje de varianza explicada por cada conjunto de datos explicativos (o combinaci&oacute;n de stets de datos)._
<br/>
#### **Step 1: Partition the Variation**
_Construir el modelo y ejecutar un RDA con las matrices (diferentes factores) separadas._
```{r}
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~ plants + land_use + margin, ~season,
~ shannon, data = env_1)
varp
```
Legendre (2008) argued that "Negative values of Adj. R<sup>2</sup> are interpreted as zeros; they correspond to cases where the explanatory variables explain less variation than random normal variables would."<br>
_Legendre (2008) sugiere que "**los valores negativos de Adj. R<sup>2</sup> se interpretan como ceros**". Estos valores corresponden a casos donde las variables explicativas explican menos variaci&oacute;n que las variables normales aleatorias"_
<br/>
#### **Step 2: Partition the Variation**
Plot the results. The plot shows the adjusted R<sup>2</sup> values associated with each partition or for overlapping partitions.<br>
_Graficar los resultados. El gr&aacute;fico muestra los valores de R<sup>2</sup> ajustados asociados con cada partici&oacute;n o para particiones superpuestas._
```{r}
plot(varp, digits = 2, Xnames = c('Enviromental factors', 'Vegetation',
"Season","Macroinvertebrates"),
bg = c('navy', 'tomato', "lightblue","gold"))
library(ggplot2)
library(dplyr)
library(vegan)
library(ggplot2)
library(dplyr)
library(vegan)
<br/>
species=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_species.csv", header=T, row.names=NULL, sep=",")
env=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_environmetal_standart.csv", header=T, row.names=NULL, sep=",")
species=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_species.csv", header=T, row.names=NULL, sep=",")
env=read.csv("D:/Curriculum/07_ Cursos/Course_Multivariate_Stat_for_Ecological_Data/data/RDA_environmetal_standart.csv", header=T, row.names=NULL, sep=",")
<br/>
#### **Step 3**
_Remover la columna de sitos._
```{r}
species_1 <- select(species, -site)
env_1 <- select(env, -site)
```
<br/>
#### **Step 4**
**_Transformar datos._** _Hellinger es una transformaci&aacute;n recomendada por Legendre & Callagher (2001) en datos de abundancia y con una respuesta lineal._
```{r}
species.hel <- decostand(species_1, method = "hellinger")
```
<br/>
## **Variation partitioning by partial RDA**
**Variation partitioning** is a type of analysis that combines **simple RDA** and **partial RDA** to divide the variation of a response variable among two, three or four explanatory data sets. Variation partitioning are generally represented by Venn diagram in which the percentage of explained variance by each explanatory data set (or combination of data stets) is reported.<br>
_**La partici&oacute;n de la variaci&oacute;n** es un tipo de an&aacute;lisis que combina un **RDA simple** y un **RDA parcial** para dividir la variaci&oacute;n de una variable de respuesta entre dos, tres o cuatro conjuntos de datos explicativos. La partici&oacute;n de variaci&oacute;n generalmente se representa mediante un diagrama de Venn en el que se informa el porcentaje de varianza explicada por cada conjunto de datos explicativos (o combinaci&oacute;n de stets de datos)._
<br/>
#### **Step 1: Partition the Variation**
_Construir el modelo y ejecutar un RDA con las matrices (diferentes factores) separadas._
```{r}
varp <- varpart(species.hel, ~ temperature + oxygen + pH + conductivity,
~ plants + land_use + margin, ~season,
~ shannon, data = env_1)
varp
```
Legendre (2008) argued that "Negative values of Adj. R<sup>2</sup> are interpreted as zeros; they correspond to cases where the explanatory variables explain less variation than random normal variables would."<br>
_Legendre (2008) sugiere que "**los valores negativos de Adj. R<sup>2</sup> se interpretan como ceros**". Estos valores corresponden a casos donde las variables explicativas explican menos variaci&oacute;n que las variables normales aleatorias"_
<br/>
#### **Step 2: Partition the Variation**
Plot the results. The plot shows the adjusted R<sup>2</sup> values associated with each partition or for overlapping partitions.<br>
_Graficar los resultados. El gr&aacute;fico muestra los valores de R<sup>2</sup> ajustados asociados con cada partici&oacute;n o para particiones superpuestas._
```{r}
plot(varp, digits = 2, Xnames = c('Enviromental factors', 'Vegetation',
"Season","Macroinvertebrates"),
bg = c('navy', 'tomato', "lightblue","gold"))
## Show values for all partitions by putting 'cutoff' low enough:
#plot(varp, cutoff = -Inf, cex = 0.7, bg=2:5)
```
<br/>
#### **Step 3: Partition the Variation**
Test the significance of each individual component.<br>
_Probar la significancia de cada componente individual._
```{r}
# significance of partition from Environment (physicochemical variables)
anova(rda(species.hel ~ temperature + oxygen + pH + conductivity +
Condition(plants + land_use + margin) +
Condition(season) + Condition(shannon), data=env_1))
# Significance of partition from Physical characteristics
anova(rda(species.hel ~ plants + land_use + margin +
Condition(temperature + oxygen + pH + conductivity) +
Condition(season) + Condition(shannon), data=env_1))
# Significance of partition from Season
anova(rda(species.hel ~ season +
Condition(plants + land_use + margin) +
Condition(temperature + oxygen + pH + conductivity)
+ Condition(shannon), data=env_1))
anova(rda(species.hel ~ shannon +
Condition(plants + land_use + margin) +
Condition(temperature + oxygen + pH + conductivity)
+ Condition(season), data=env_1))
# significance of partition from Environment (physicochemical variables)
anova(rda(species.hel ~ temperature + oxygen + pH + conductivity +
Condition(plants + land_use + margin) +
Condition(season) + Condition(shannon), data=env_1))
# Significance of partition from Physical characteristics
anova(rda(species.hel ~ plants + land_use + margin +
Condition(temperature + oxygen + pH + conductivity) +
Condition(season) + Condition(shannon), data=env_1))
# Significance of partition from Season
anova(rda(species.hel ~ season +
Condition(plants + land_use + margin) +
Condition(temperature + oxygen + pH + conductivity)
+ Condition(shannon), data=env_1))
anova(rda(species.hel ~ shannon +
Condition(plants + land_use + margin) +
Condition(temperature + oxygen + pH + conductivity)
+ Condition(season), data=env_1))
# Significance of partition from Season
anova(rda(species.hel ~ shannon +
Condition(plants + land_use + margin) +
Condition(temperature + oxygen + pH + conductivity) +
Condition(season), data=env_1))
```{r pressure, echo=FALSE, fig.cap="A caption", out.width = '100%'}
knitr::include_graphics("/assets/img/StatsFunny.jpg")
knitr::include_graphics("D:/Curriculum/19_ Personal webpage/
TropicalFreshwaterEcology/assets/img/StatsFunny.jpeg")
?lm
Wingcrd <- c(59, 55, 53.5, 55, 52.5, 57.5, 53, 55)
Wingcrd
Wingcrd [3]
Wingcrd [1 : 5]
Wingcrd [-2]
sum(Wingcrd)
s.win <- sum(Wingcrd)
s.win
Tarsus <- c(22.3, 19.7, 20.8, 20.3, 20.8, 21.5, 20.6,21.5)
Head <- c(31.2, 30.4, 30.6, 30.3, 30.3, 30.8, 32.5,NA)
Wt <- c(9.5, 13.8, 14.8, 15.2, 15.5, 15.6, 15.6,15.7)
Bird<-c(Tarsus,Head,Wt)
Bird
Bird1 <- cbind(Tarsus, Head, Wt)
Bird1
Bird2 <- rbind(Tarsus, Head, Wt)
Bird2
x<-c(1:8,NA)
mean(x)
x
mean(x)
Head <-c(31.2,30.4,30.6,30.3,30.8,NA,32.5,NA)
Head
sum(Head)
sum(Head, na.rm=TRUE)
####   na.rm=TRUE
```{r}
mean(x,na.rm=T)
```
mean(x,na.rm=T)
cherry <- read.csv(file.choose(), dec=’.’, sep=’;’)
cherry <- read.csv(file.choose(), dec='.', sep=';')
cherry
data<-read.table(file.choose(),header=T)
install.packages("xaringan")
library(xaringan)
source('~/.active-rstudio-document', echo=TRUE)
